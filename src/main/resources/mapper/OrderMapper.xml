<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
 <mapper namespace="com.team2.finalproject.mapper.OrderMapper">
 
 	 	<insert id="insertOrder">
 	 		INSERT INTO orders
 	 			values(
 	 				order_no_seq.NEXTVAL,
 	 				#{userNo},
 	 			 	#{productQuantity},
 	 				#{usedPoint},
 	 				#{basicAddr},
 	 				#{detailAddr},
 	 				#{paymentMethod},
 	 				sysdate,
 	 				#{deliveryCharge},
 	 				#{price},
 	 				1
 	 			)
 	 	</insert>

 	 	<insert id="insertOrderDetail">
 	 		INSERT INTO order_detail
 	 			values(
 	 				order_detail_no_seq.NEXTVAL,
 	 				#{productCode},
 	 				#{orderNo},
 	 				(SELECT price
                     FROM product
                     WHERE product_code = #{productCode}),
 	 				#{productQuantity}
 	 			)
 	 	</insert>
 	 	
 		<select id="getOrderNoByUserNo">
 			SELECT MAX(order_no)
 			FROM orders
 			WHERE user_no = #{user_no}
 		</select>
 	 	
 </mapper>